---
# Alter /etc/hosts with main domain and alternative domains
- blockinfile:
    dest: /etc/hosts
    marker: "# {mark} {{cops_drupal_vars.name}} local main name resolution :: DO NOT EDIT --"
    insertafter: EOF
    block: |
           {% set hostsentries = [] %}
           {% for alias in cops_drupal_vars.nginx.server_aliases -%}
           {%    set _ = hostsentries.append(('127.0.0.1', alias))%}
           {% endfor %}
           {% set _ = hostsentries.append(('127.0.0.1', cops_drupal_vars.domain )) %}
           {% for ip, text in hostsentries %}{{-ip}} {{text}}
           {% endfor %}
  when: 'cops_drupal_vars.use_etc_hosts'
